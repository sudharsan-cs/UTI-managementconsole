'use strict'
const PATH = require('path');
require(PATH.join(__dirname, '..', '..', 'utils', 'mongo-connection'));
const SCHEMA = require('mongoose').Schema;

var iocModelObj = SCHEMA({
  "labels": {
    type: Array
  },
  "x_mitre_domains": {
    type: Array
  },
  "object_marking_refs": {
    type: Array
  },
  "id": {
    type: String
  },
  "type":{
    type: String
  },
  "malware_category":{
    type: String
  },
  "created": {
    type: String
  },
  "created_by_ref": {
    type: String
  },
  "external_references": {
    type: Array
  },
  "modified": {
    type: String
  },
  "name": {
    type: String
  },
  "description": {
    type: String
  },
  "x_mitre_version": {
    type: String
  },
  "x_mitre_attack_spec_version": {
    type: String
  },
  "x_mitre_modified_by_ref": {
    type: String
  },
  "techniqueMapping": {
    type: Array
  }
}, {
  collection: 'mitreMalwareCollection'
});

module.exports = mongoDB.model('mitreMalwareCollection', iocModelObj)